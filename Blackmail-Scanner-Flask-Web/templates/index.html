<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blackmail Check - File Scanner</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-top: 20px;
            padding: 30px;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .logo {
            font-size: 2.5rem;
            font-weight: bold;
            color: #764ba2;
            margin-bottom: 10px;
        }
        .subtitle {
            color: #6c757d;
            font-size: 1.1rem;
        }
        .stats-row {
            margin-bottom: 20px;
        }
        .stat-card {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            margin-bottom: 10px;
        }
        .stat-number {
            font-size: 2rem;
            font-weight: bold;
        }
        .stat-label {
            color: #6c757d;
            font-size: 0.9rem;
        }
        .sfw { color: #28a745; }
        .nsfw { color: #dc3545; }
        .pending { color: #ffc107; }
        .failed { color: #6c757d; }
        .unknown { color: #17a2b8; }
        
        .action-buttons {
            text-align: center;
            margin: 20px 0;
        }
        
        #results-table {
            font-size: 0.9rem;
        }
        
        .badge-sfw {
            background-color: #28a745;
        }
        .badge-nsfw {
            background-color: #dc3545;
        }
        .badge-pending {
            background-color: #ffc107;
            color: #000;
        }
        .badge-failed {
            background-color: #6c757d;
        }
        .badge-unknown {
            background-color: #17a2b8;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">üõ°Ô∏è Blackmail Check</div>
            <div class="subtitle">Digital Vulnerability Assessment Tool</div>
        </div>

        <div class="action-buttons">
            <a href="/scan" class="btn btn-primary btn-lg me-3">üîç Run New Scan</a>
            <a href="/" class="btn btn-outline-secondary btn-lg">üîÑ Refresh Results</a>
        </div>

        <div class="row stats-row">
            <div class="col-md-3">
                <div class="stat-card">
                    <div class="stat-number sfw" id="sfw-count">-</div>
                    <div class="stat-label">Safe Files (SFW)</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stat-card">
                    <div class="stat-number nsfw" id="nsfw-count">-</div>
                    <div class="stat-label">Risk Files (NSFW)</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stat-card">
                    <div class="stat-number pending" id="pending-count">-</div>
                    <div class="stat-label">Pending Analysis</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stat-card">
                    <div class="stat-number failed" id="failed-count">-</div>
                    <div class="stat-label">Failed/Unknown</div>
                </div>
            </div>
        </div>

        <div class="table-responsive">
            {{ table_data|safe }}
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Count and display statistics
        document.addEventListener('DOMContentLoaded', function() {
            const table = document.getElementById('results-table');
            if (table) {
                const rows = table.getElementsByTagName('tbody')[0].getElementsByTagName('tr');
                let sfwCount = 0, nsfwCount = 0, pendingCount = 0, failedCount = 0;
                
                for (let row of rows) {
                    const severityCell = row.cells[2]; // Assuming severity is the 3rd column
                    if (severityCell) {
                        const severity = severityCell.textContent.trim();
                        if (severity === 'SFW') sfwCount++;
                        else if (severity === 'NSFW') nsfwCount++;
                        else if (severity === 'PENDING') pendingCount++;
                        else if (severity === 'FAILED' || severity === 'UNKNOWN') failedCount++;
                        
                        // Add badges to severity cells
                        if (severity === 'SFW') {
                            severityCell.innerHTML = '<span class="badge badge-sfw">SFW</span>';
                        } else if (severity === 'NSFW') {
                            severityCell.innerHTML = '<span class="badge badge-nsfw">NSFW</span>';
                        } else if (severity === 'PENDING') {
                            severityCell.innerHTML = '<span class="badge badge-pending">PENDING</span>';
                        } else if (severity === 'FAILED') {
                            severityCell.innerHTML = '<span class="badge badge-failed">FAILED</span>';
                        } else if (severity === 'UNKNOWN') {
                            severityCell.innerHTML = '<span class="badge badge-unknown">UNKNOWN</span>';
                        }
                    }
                }
                
                document.getElementById('sfw-count').textContent = sfwCount;
                document.getElementById('nsfw-count').textContent = nsfwCount;
                document.getElementById('pending-count').textContent = pendingCount;
                document.getElementById('failed-count').textContent = failedCount;
            }
        });
    </script>
</body>
</html>